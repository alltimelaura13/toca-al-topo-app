{"ast":null,"code":"import { BehaviorSubject, concatMap, delay, fromEvent, map, merge, scan, shareReplay, startWith, take, takeUntil, timer } from 'rxjs';\nimport { salto, tiempoJuego, tocarAlTopo } from '../custom-operators';\nimport { SCORE_ACTION } from '../topo/topo.enum';\nconst createStartButtonObservable = btnNativeElement => fromEvent(btnNativeElement, 'click').pipe(map(() => SCORE_ACTION.RESET), shareReplay(1));\nconst createScoreObservable = (startButtonClicked$, moles) => {\n  const molesClickedArray$ = moles.map(({\n    nativeElement\n  }) => fromEvent(nativeElement, 'click').pipe(tocarAlTopo(nativeElement)));\n  return merge(...molesClickedArray$, startButtonClicked$).pipe(scan((score, action) => action === SCORE_ACTION.RESET ? 0 : score + 1, 0), startWith(0));\n};\nexport const createGameObservablesFn = () => {\n  const delayTime = 3;\n  const gameDuration = 10;\n  const MILLISECOND = 1000;\n  return (btnNativeElement, moles, holes, dificultad) => {\n    let tiempoEntrada = 350;\n    let tiempoSalida = 1000;\n    debugger;\n    switch (dificultad) {\n      case '1':\n        tiempoEntrada = 1000;\n        tiempoSalida = 2000;\n        break;\n      case '2':\n        tiempoEntrada = 500;\n        tiempoSalida = 1000;\n        break;\n      case '3':\n        tiempoEntrada = 120;\n        tiempoSalida = 500;\n        break;\n      default:\n        tiempoEntrada = 350;\n        tiempoSalida = 1000;\n        break;\n    }\n    const startButtonClicked$ = createStartButtonObservable(btnNativeElement);\n    const score$ = createScoreObservable(startButtonClicked$, moles);\n    const delayGameMsg$ = startButtonClicked$.pipe(concatMap(() => timer(0, MILLISECOND).pipe(take(delayTime + 1), map(value => delayTime - value))));\n    const resetTime$ = startButtonClicked$.pipe(map(() => gameDuration));\n    const delayGameStart$ = startButtonClicked$.pipe(delay(delayTime * MILLISECOND), shareReplay(1));\n    const timeLeft$ = merge(resetTime$, delayGameStart$.pipe(tiempoJuego(gameDuration)));\n    const lastHoleUpdated = new BehaviorSubject(-1);\n    const createGame$ = delayGameStart$.pipe(concatMap(() => lastHoleUpdated.pipe(salto(holes, tiempoEntrada, tiempoSalida), takeUntil(timer(gameDuration * MILLISECOND)))));\n    return {\n      delayGameMsg$,\n      timeLeft$,\n      score$,\n      createGame$\n    };\n  };\n};","map":{"version":3,"names":["BehaviorSubject","concatMap","delay","fromEvent","map","merge","scan","shareReplay","startWith","take","takeUntil","timer","salto","tiempoJuego","tocarAlTopo","SCORE_ACTION","createStartButtonObservable","btnNativeElement","pipe","RESET","createScoreObservable","startButtonClicked$","moles","molesClickedArray$","nativeElement","score","action","createGameObservablesFn","delayTime","gameDuration","MILLISECOND","holes","dificultad","tiempoEntrada","tiempoSalida","score$","delayGameMsg$","value","resetTime$","delayGameStart$","timeLeft$","lastHoleUpdated","createGame$"],"sources":["C:\\Users\\lamarcos\\Proyectos\\topo-app\\src\\app\\game\\helpers\\topo.observable.ts"],"sourcesContent":["import { ElementRef } from '@angular/core';\nimport {\n  BehaviorSubject,\n  Observable,\n  concatMap,\n  delay,\n  fromEvent,\n  map,\n  merge,\n  scan,\n  shareReplay,\n  startWith,\n  take,\n  takeUntil,\n  timer,\n} from 'rxjs';\nimport { salto, tiempoJuego, tocarAlTopo } from '../custom-operators';\nimport { SCORE_ACTION } from '../topo/topo.enum';\n\nconst createStartButtonObservable = (btnNativeElement: HTMLButtonElement) =>\n  fromEvent(btnNativeElement, 'click').pipe(\n    map(() => SCORE_ACTION.RESET),\n    shareReplay(1),\n  );\n\nconst createScoreObservable = (startButtonClicked$: Observable<SCORE_ACTION>, moles: ElementRef<HTMLDivElement>[]) => {\n  const molesClickedArray$ = moles.map(({ nativeElement }) =>\n    fromEvent(nativeElement, 'click').pipe(tocarAlTopo(nativeElement)),\n  );\n\n  return merge(...molesClickedArray$, startButtonClicked$).pipe(\n    scan((score, action) => (action === SCORE_ACTION.RESET ? 0 : score + 1), 0),\n    startWith(0),\n  );\n};\n\nexport const createGameObservablesFn = () => {\n  const delayTime = 3;\n  const gameDuration = 10;\n  const MILLISECOND = 1000;\n\n\n\n  return (\n    btnNativeElement: HTMLButtonElement,\n    moles: ElementRef<HTMLDivElement>[],\n    holes: ElementRef<HTMLDivElement>[],\n    dificultad?:any\n  ) => {\n    let tiempoEntrada: number = 350;\n    let tiempoSalida: number = 1000;\ndebugger\n    switch (dificultad) {\n      case '1':\n        tiempoEntrada = 1000;\n       tiempoSalida = 2000;\n        break;\n        case '2':\n          tiempoEntrada = 500;\n          tiempoSalida = 1000;\n        break;\n        case '3':\n          tiempoEntrada = 120;\n          tiempoSalida = 500;\n        break;\n      default:\n        tiempoEntrada = 350;\n        tiempoSalida = 1000;\n        break;\n    }\n    \n    const startButtonClicked$ = createStartButtonObservable(btnNativeElement);\n    const score$ = createScoreObservable(startButtonClicked$, moles);\n    const delayGameMsg$ = startButtonClicked$.pipe(\n      concatMap(() =>\n        timer(0, MILLISECOND).pipe(\n          take(delayTime + 1),\n          map((value) => delayTime - value),\n        ),\n      ),\n    );\n\n    const resetTime$ = startButtonClicked$.pipe(map(() => gameDuration));\n    const delayGameStart$ = startButtonClicked$.pipe(delay(delayTime * MILLISECOND), shareReplay(1));\n    const timeLeft$ = merge(resetTime$, delayGameStart$.pipe(tiempoJuego(gameDuration)));\n    const lastHoleUpdated = new BehaviorSubject<number>(-1);\n    const createGame$ = delayGameStart$.pipe(\n      concatMap(() => lastHoleUpdated.pipe(salto(holes, tiempoEntrada, tiempoSalida), takeUntil(timer(gameDuration * MILLISECOND)))),\n    );\n\n    return {\n      delayGameMsg$,\n      timeLeft$,\n      score$,\n      createGame$,\n    };\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}